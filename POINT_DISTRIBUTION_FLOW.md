# ν¬μΈνΈ μ§€κΈ‰ ν”λ΅μ° λ‹¤μ΄μ–΄κ·Έλ¨

## π“ μ „μ²΄ ν”λ΅μ°

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 1λ‹¨κ³„: μ‚¬μ©μ ν¬ν‘ μ μ¶                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
                    β–Ό
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚ submitVote1()         β”‚  (μ΄μ§„/λ‹¤μ¤‘/μ£Όκ΄€μ‹)
        β”‚ submitVote2()         β”‚  (μ»¤ν” λ§¤μΉ­)
        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
                    β–Ό
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚ t_pickresult1 μ €μ¥     β”‚  (μ΄μ§„/λ‹¤μ¤‘/μ£Όκ΄€μ‹)
        β”‚ t_pickresult2 μ €μ¥     β”‚  (μ»¤ν” λ§¤μΉ­)
        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
                    β”‚ (ν¬μΈνΈ μ§€κΈ‰ β μ•„μ§ μ—†μ)
                    β”‚
                    β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 2λ‹¨κ³„: λ―Έμ… ν™•μ •                                                β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚                       β”‚
        β–Ό                       β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ μμΈ΅ν”½/μ£Όκ΄€μ‹ β”‚      β”‚ λ‹¤μν”½         β”‚
β”‚ κ΄€λ¦¬μ μ…λ ¥   β”‚      β”‚ μλ™ ν™•μ •     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚                       β”‚
        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
                    β–Ό
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚ settleMission1()       β”‚
        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
                    β–Ό
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚ t_missions1 μƒνƒ λ³€κ²½  β”‚
        β”‚ f_status = "settled"   β”‚
        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
                    β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 3λ‹¨κ³„: ν¬μΈνΈ μ§€κΈ‰ (μλ™ μ‹¤ν–‰)                                  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚                       β”‚
        β–Ό                       β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ distributePoints  β”‚  β”‚ distributePoints  β”‚
β”‚ ForMission1()     β”‚  β”‚ ForMission2()     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚                       β”‚
        β”‚ 1. t_pickresult1 μ΅°ν  β”‚ 1. t_pickresult2 μ΅°ν
        β”‚ 2. t_missions1 μ΅°ν    β”‚ 2. t_missions2 μ΅°ν
        β”‚    (μ •λ‹µ/λ‹¤μ μµμ…)     β”‚    (μµμΆ… μ •λ‹µ)
        β”‚ 3. ν¬μΈνΈ κ³„μ‚°         β”‚ 3. νμ°¨λ³„ ν¬μΈνΈ κ³„μ‚°
        β”‚                       β”‚
        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
                    β–Ό
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚ calculateBinaryMulti  β”‚  (μ΄μ§„: 10P, λ‹¤μ¤‘: μµμ…μΓ—10P)
        β”‚ Points()              β”‚
        β”‚ calculateMatchPoints()β”‚  (νμ°¨λ³„: 100Pβ†’90Pβ†’...β†’30P)
        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
                    β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 4λ‹¨κ³„: ν¬μΈνΈ μ €μ¥ λ° μ‚¬μ©μ μ—…λ°μ΄νΈ                           β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
                    β–Ό
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚ addPointLog()         β”‚
        β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚
        β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
        β”‚                       β”‚
        β–Ό                       β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ t_pointlogs μ €μ¥   β”‚  β”‚ t_users μ—…λ°μ΄νΈ   β”‚
β”‚ (λ΅κ·Έ κΈ°λ΅)        β”‚  β”‚ f_points += diff   β”‚
β”‚                    β”‚  β”‚ f_tier μλ™ κ³„μ‚°   β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## π”„ λ―Έμ… νƒ€μ…λ³„ μƒμ„Έ ν”λ΅μ°

### μ΄μ§„/λ‹¤μ¤‘/μ£Όκ΄€μ‹ λ―Έμ… (t_missions1)

```
μ‚¬μ©μ ν¬ν‘
    β”‚
    β–Ό
t_pickresult1 μ €μ¥
    β”‚
    β–Ό
[λ―Έμ… ν™•μ • λ€κΈ°]
    β”‚
    β”β”€ μμΈ΅ν”½/μ£Όκ΄€μ‹: κ΄€λ¦¬μκ°€ μ •λ‹µ μ…λ ¥
    β””β”€ λ‹¤μν”½: λ§κ° ν›„ μλ™ ν™•μ •
    β”‚
    β–Ό
settleMission1() νΈμ¶
    β”‚
    β”β”€ t_missions1.f_status = "settled"
    β”‚
    β””β”€ distributePointsForMission1() νΈμ¶
        β”‚
        β”β”€ t_pickresult1μ—μ„ λ¨λ“  ν¬ν‘ μ΅°ν
        β”β”€ t_missions1μ—μ„ μ •λ‹µ/λ‹¤μ μµμ… μ΅°ν
        β”‚
        β””β”€ κ° μ°Έμ—¬μλ³„λ΅:
            β”β”€ μ •λ‹µ μ—¬λ¶€ ν™•μΈ
            β”β”€ calculateBinaryMultiPoints()λ΅ ν¬μΈνΈ κ³„μ‚°
            β””β”€ addPointLog() νΈμ¶
                β”‚
                β”β”€ t_pointlogsμ— λ΅κ·Έ μ €μ¥
                β””β”€ t_users ν¬μΈνΈ/ν‹°μ–΄ μ—…λ°μ΄νΈ
```

### μ»¤ν” λ§¤μΉ­ λ―Έμ… (t_missions2)

```
μ‚¬μ©μ ν¬ν‘ (νμ°¨λ³„)
    β”‚
    β–Ό
t_pickresult2 μ €μ¥ (f_episode_noλ³„)
    β”‚
    β–Ό
[λ―Έμ… ν™•μ • λ€κΈ°]
    β”‚
    β””β”€ λ§κ° ν›„ μλ™ ν™•μ • (checkAndAutoSettleCoupleMission)
    β”‚
    β–Ό
distributePointsForMission2() νΈμ¶
    β”‚
    β”β”€ t_pickresult2μ—μ„ λ¨λ“  ν¬ν‘ μ΅°ν (λ¨λ“  νμ°¨)
    β”β”€ t_missions2μ—μ„ μµμΆ… μ •λ‹µ μ΅°ν
    β”‚
    β””β”€ κ° μ°Έμ—¬μλ³„λ΅:
        β”β”€ νμ°¨λ³„λ΅ μ •λ‹µ μ—¬λ¶€ ν™•μΈ
        β”β”€ calculateMatchPoints()λ΅ ν¬μΈνΈ κ³„μ‚°
        β”‚   β”β”€ μ •λ‹µ: +νμ°¨ μ μ (100Pβ†’90Pβ†’...β†’30P)
        β”‚   β””β”€ μ¤λ‹µ: -νμ°¨ μ μ
        β””β”€ addPointLog() νΈμ¶ (νμ°¨λ³„λ΅)
            β”‚
            β”β”€ t_pointlogsμ— λ΅κ·Έ μ €μ¥
            β””β”€ t_users ν¬μΈνΈ/ν‹°μ–΄ μ—…λ°μ΄νΈ
```

## π“‹ μ£Όμ” DB ν…μ΄λΈ” μ—­ν• 

| ν…μ΄λΈ” | μ—­ν•  | μ£Όμ” μ»¬λΌ |
|--------|------|-----------|
| `t_pickresult1` | μ΄μ§„/λ‹¤μ¤‘/μ£Όκ΄€μ‹ ν¬ν‘ μ €μ¥ | `f_user_id`, `f_mission_id`, `f_selected_option` |
| `t_pickresult2` | μ»¤ν” λ§¤μΉ­ ν¬ν‘ μ €μ¥ | `f_user_id`, `f_mission_id`, `f_episode_no`, `f_connections` |
| `t_missions1` | μ΄μ§„/λ‹¤μ¤‘/μ£Όκ΄€μ‹ λ―Έμ… μ •λ³΄ | `f_status`, `f_correct_answer`, `f_majority_option`, `f_kind` |
| `t_missions2` | μ»¤ν” λ§¤μΉ­ λ―Έμ… μ •λ³΄ | `f_status`, `f_final_answer`, `f_total_episodes` |
| `t_pointlogs` | ν¬μΈνΈ λ³€λ™ λ΅κ·Έ | `f_user_id`, `f_mission_id`, `f_diff`, `f_reason` |
| `t_users` | μ‚¬μ©μ ν¬μΈνΈ λ° ν‹°μ–΄ | `f_points`, `f_tier` |

## π― ν¬μΈνΈ κ³„μ‚° κ·μΉ™

### μ΄μ§„/λ‹¤μ¤‘ μ„ νƒ
- **μ΄μ§„**: μ •λ‹µ μ‹ **+10P**, μ¤λ‹µ **0P**
- **λ‹¤μ¤‘**: μ •λ‹µ μ‹ **μµμ…μ Γ— 10P** (3μ§€μ„ λ‹¤: 30P, 4μ§€μ„ λ‹¤: 40P, 5μ§€μ„ λ‹¤: 50P), μ¤λ‹µ **0P**

### μ»¤ν” λ§¤μΉ­
- **νμ°¨λ³„ μ μ**: 1νμ°¨ 100P β†’ νμ°¨λ§λ‹¤ 10P κ°μ† β†’ μµμ† 30P
- **μ •λ‹µ**: **+νμ°¨ μ μ**
- **μ¤λ‹µ**: **-νμ°¨ μ μ**

## β οΈ μ¤‘μ” ν¬μΈνΈ

1. **ν¬ν‘ μ μ¶ μ‹μ μ—λ” ν¬μΈνΈ μ§€κΈ‰ μ• λ¨** β
2. **λ―Έμ… ν™•μ • μ‹μ μ—λ§ ν¬μΈνΈ μ§€κΈ‰** β…
3. **ν• λ²λ§ μ§€κΈ‰**: `settled` μƒνƒ μ²΄ν¬λ΅ μ¤‘λ³µ μ§€κΈ‰ λ°©μ§€
4. **ν‹°μ–΄ μλ™ μ—…λ°μ΄νΈ**: ν¬μΈνΈ λ³€κ²½ μ‹ `getTierFromPoints()`λ΅ μλ™ κ³„μ‚°

